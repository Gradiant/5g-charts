{{- if .Values.smf.enabled }}
{{- $component := .Values.smf | deepCopy }}
{{- $values := merge (dict "Values" $component "component" "smf" "freeDiameter" true) . }}
{{ template "open5gs.deployment" $values }}
---
{{ template "open5gs.configmap" $values }}
---
{{ template "open5gs.diameter-configmap" $values }}
---
{{ template "open5gs.hpa" $values }}
---
{{- if $component.metrics.serviceMonitor.enabled }}
{{ template "open5gs.servicemonitor" $values }}
{{- end }}
---
{{- range $k, $v := $component.services }}
{{- $_ := set $component "service" $v }}
{{- $values := merge (dict "Values" $component "component" "smf" "service" $k) $ }}
{{ template "open5gs.svc" $values }}
---
{{- end }}
{{- end }}
